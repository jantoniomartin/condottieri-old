{% extends 'machiavelli/show_game.html' %}

{% load i18n %}

{% block actions %}
<h2>{% trans "Military Adjustment" %}</h2>
<h3>{% trans "Military unit payment" %}</h3>
{% if done %}

<p>{% blocktrans %}At least one player has not yet adjusted his units. You have to wait until all
players have done it or the time limit is reached.{% endblocktrans %}</p>

{% else %}

<p>{% blocktrans %}You must select which of your existing units you will pay
in order to keep them in play. You will pay 3 ducats for every unit that you
select. The units not selected will be disbanded.</p>{% endblocktrans %}

<form action="{% url show-game game.slug %}" method="post">
{% csrf_token %}

<div class="action_form">
<p>{{ formset.non_form_errors }}</p>
{{ formset.management_form }}

{# Taken from http://djangosnippets.org/snippets/1442/ #}
<table style="width: 40%; min-width: 30em;">
{% for form in formset.forms %}
	{% if forloop.first %}
	<thead><tr>
		{% for field in form.visible_fields %}
		<th>{{ field.label|capfirst }}</th>
		{% endfor %}
	</tr></thead>
	{% endif %}
	<tr>
	{% for field in form.visible_fields %}
		<td>
		{% if forloop.first %}
			{% for hidden in form.hidden_fields %}
			{{ hidden }}
			{% endfor %}
		{% endif %}
			{{ field.errors.as_ul }}
			{{ field }}
		</td>
	{% endfor %}
	</tr>
{% endfor %}
</table>

<p><input type="submit" value="{% trans "Buy units" %}" /></p>
</div>

</form>
{% endif %}

{% endblock %}
